<html>

<head>
  <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js'></script>
  <script type='text/javascript'>
    $(document).ready(function () {
      $('body').append(`<p id="prediction">Prediction: <p>`);
      $.fn.serializeObject = function () {
        var object = {};
        $.each(this.serializeArray(), function () {
          if (object[this.name] !== undefined) {
            [object[this.name]].push(this.value || '');
          } else {
            object[this.name] = this.value || '';
          }
        });
        return object;
      };
      var DATA;
      function predict(data = DATA) {
        console.log('data', DATA);
        var ENDPOINT = $('[name=url]').val();
        return fetch(ENDPOINT, {
          method: 'POST',
          body: data,
        })
          .then((res) => res.json())
          .then((resJSON) => {
            console.log('resJSON', resJSON);
            resJSON = JSON.parse(resJSON['body']);
            var innerHTML = $('#prediction').filter('p').text();
            var label = innerHTML.substring(innerHTML.indexOf('Prediction:') + 'Prediction:'.length);
            $('#prediction').html($('#prediction').html().replace(label, resJSON['predicted_label']));
          })
          .catch(err => console.log('err', err));
      };
      $('#PredictButton').click(function (data = DATA) {
        DATA = JSON.stringify($('form').serializeObject());
        predict();
      });
    });
  </script>
</head>

<body>

  <p>Housing Median Price Prediction Service</p>

  Url:<br>
  <input type="text" name="url">
  <br>
  <form id="myform">
    Longitude:<br>
    <input type="text" name="longitude" value="37">
    <br>
    Latitude: <br>
    <input type="number" name="latitude" value="1">
    <br>
    Housing Median Age:<br>
    <input type="number" name="housing_median_age" value="3">
    <br>
    Total Rooms:<br>
    <input type="number" name="total_rooms" value="130">
    <br>
    Total Bedrooms:<br>
    <input type="number" name="total_bedrooms" value="250">
    <br>
    Population:<br>
    <input type="number" name="population" value="0">
    <br>
    Households:<br>
    <input type="number" name="households" value="0">
    <br>
    Median Income:<br>
    <input type="number" name="median_income" value="187">
    <br>
    Less than 1H Ocean:<br>
    <input type="number" name="<1H OCEAN" value="187">
    <br>
    INLAND:<br>
    <input type="number" name="INLAND" value="187">
    <br>
    ISLAND:<br>
    <input type="number" name="ISLAND" value="187">
    <br>
    NEAR BAY:<br>
    <input type="number" name="NEAR BAY" value="187">
    <br>
    NEAR OCEAN:<br>
    <input type="number" name="NEAR OCEAN" value="187">
    <br>
    <br>
    <input type="button" value="Predict" id="PredictButton">
  </form>


</body>

</html>